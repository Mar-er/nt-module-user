{"version":3,"sources":["../src/services/user.service.ts"],"names":[],"mappings":"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","file":"user.service.js","sourcesContent":["import { forwardRef, HttpException, Inject, Injectable } from '@nestjs/common';\nimport { InjectRepository } from '@nestjs/typeorm';\nimport { SmsComponent } from '@notadd/addon-sms';\nimport { __ as t } from 'i18n';\nimport { Repository } from 'typeorm';\n\nimport { AuthService } from '../auth/auth.service';\nimport { InfoItem } from '../entities/info-item.entity';\nimport { UserInfo } from '../entities/user-info.entity';\nimport { User } from '../entities/user.entity';\nimport { CreateUserInput, UpdateUserInput, UserInfoData } from '../interfaces/user.interface';\nimport { CryptoUtil } from '../utils/crypto.util';\nimport { RoleService } from './role.service';\n\n@Injectable()\nexport class UserService {\n    constructor(\n        @InjectRepository(User) private readonly userRepo: Repository<User>,\n        @InjectRepository(UserInfo) private readonly userInfoRepo: Repository<UserInfo>,\n        @InjectRepository(InfoItem) private readonly infoItemRepo: Repository<InfoItem>,\n        @Inject(CryptoUtil) private readonly cryptoUtil: CryptoUtil,\n        @Inject(forwardRef(() => AuthService)) private readonly authService: AuthService,\n        @Inject(RoleService) private readonly roleService: RoleService,\n        @Inject('SmsComponentToken') private readonly smsComponentProvider: SmsComponent\n    ) { }\n\n    /**\n     * Cteate a user\n     *\n     * @param user The user object\n     */\n    async createUser(createUserInput: CreateUserInput): Promise<void> {\n        if (!(createUserInput.username || createUserInput.mobile || createUserInput.email)) {\n            throw new HttpException(t('Please make sure the username, mobile phone number, and email exist at least one'), 406);\n        }\n        if (createUserInput.username && await this.userRepo.findOne({ where: { username: createUserInput.username } })) {\n            throw new HttpException(t('Username already exists'), 409);\n        }\n        if (createUserInput.mobile && await this.userRepo.findOne({ where: { mobile: createUserInput.mobile } })) {\n            throw new HttpException(t('Mobile already exists'), 409);\n        }\n        if (createUserInput.email && await this.userRepo.findOne({ where: { email: createUserInput.email } })) {\n            throw new HttpException(t('Email already exists'), 409);\n        }\n\n        createUserInput.password = await this.cryptoUtil.encryptPassword(createUserInput.password);\n        if (createUserInput.email) createUserInput.email = createUserInput.email.toLocaleLowerCase();\n        const user = await this.userRepo.save(this.userRepo.create(createUserInput));\n\n        if (createUserInput.roleIds && createUserInput.roleIds.length) {\n            await this.userRepo.createQueryBuilder('user').relation(User, 'roles').of(user).add(createUserInput.roleIds);\n        }\n        if (createUserInput.organizationIds && createUserInput.organizationIds.length) {\n            await this.userRepo.createQueryBuilder('user').relation(User, 'organizations').of(user).add(createUserInput.organizationIds);\n        }\n        if (createUserInput.infoKVs && createUserInput.infoKVs.length) {\n            await this.createOrUpdateUserInfos(user, createUserInput.infoKVs, 'create');\n        }\n    }\n\n    /**\n     * Add a role to the user\n     *\n     * @param userId The specified user id\n     * @param roleId The specified role id\n     */\n    async addUserRole(userId: number, roleId: number) {\n        await this.userRepo.createQueryBuilder('user').relation(User, 'roles').of(userId).add(roleId);\n    }\n\n    /**\n     * Delete a role from the user\n     *\n     * @param userId The specified user id\n     * @param roleId The specified role id\n     */\n    async deleteUserRole(userId: number, roleId: number) {\n        await this.userRepo.createQueryBuilder('user').relation(User, 'roles').of(userId).remove(roleId);\n    }\n\n    /**\n     * Delete user to recycle bin or ban user\n     *\n     * @param id The specified user id\n     */\n    async recycleOrBanUser(id: number, action: 'recycle' | 'ban'): Promise<void> {\n        const user = await this.findOneById(id);\n        if (action === 'recycle') {\n            user.recycle = true;\n        }\n        if (action === 'ban') {\n            user.banned = true;\n        }\n        await this.userRepo.save(user);\n    }\n\n    /**\n     * Delete users in the recycle bin\n     *\n     * @param id The specified user id\n     */\n    async deleteUser(id: number): Promise<void> {\n        const user = await this.userRepo.findOne(id, { relations: ['roles', 'organizations'] });\n        await this.userRepo.createQueryBuilder('user').relation(User, 'roles').of(user).remove(user.roles);\n        await this.userRepo.createQueryBuilder('user').relation(User, 'organizations').of(user).remove(user.organizations);\n        await this.userRepo.remove(user);\n    }\n\n    /**\n     * Revert user from which was banned or recycled\n     *\n     * @param id The specified user id\n     */\n    async revertBannedOrRecycledUser(id: number, status: 'recycled' | 'banned') {\n        const user = await this.findOneById(id);\n        if (status === 'recycled') {\n            user.recycle = false;\n        }\n        if (status === 'banned') {\n            user.banned = false;\n        }\n        await this.userRepo.save(user);\n    }\n\n    /**\n     * Update user's information\n     *\n     * @param id The specified user id\n     * @param updateUserInput The information to be update\n     */\n    async updateUserInfo(id: number, updateUserInput: UpdateUserInput): Promise<void> {\n        const user = await this.userRepo.findOne(id, { relations: ['userInfos'] });\n\n        if (updateUserInput.username && updateUserInput.username !== user.username) {\n            if (await this.userRepo.findOne({ where: { username: updateUserInput.username } })) {\n                throw new HttpException(t('Username already exists'), 409);\n            }\n            await this.userRepo.update(user.id, { username: updateUserInput.username });\n        }\n        if (updateUserInput.mobile && updateUserInput.mobile !== user.mobile) {\n            if (await this.userRepo.findOne({ where: { mobile: updateUserInput.mobile } })) {\n                throw new HttpException(t('Mobile already exists'), 409);\n            }\n            await this.userRepo.update(user.id, { mobile: updateUserInput.mobile });\n        }\n        if (updateUserInput.email && updateUserInput.email !== user.email) {\n            if (await this.userRepo.findOne({ where: { email: updateUserInput.email } })) {\n                throw new HttpException(t('Email already exists'), 409);\n            }\n            await this.userRepo.update(user.id, { email: updateUserInput.email.toLocaleLowerCase() });\n        }\n\n        if (updateUserInput.password) {\n            const newPassword = await this.cryptoUtil.encryptPassword(updateUserInput.password);\n            await this.userRepo.update(user.id, { password: newPassword });\n        }\n        if (updateUserInput.roleIds && updateUserInput.roleIds.length) {\n            updateUserInput.roleIds.forEach(async roleId => {\n                await this.userRepo.createQueryBuilder('user').relation(User, 'roles').of(user).remove(roleId.before);\n                await this.userRepo.createQueryBuilder('user').relation(User, 'roles').of(user).add(roleId.after);\n            });\n        }\n        if (updateUserInput.organizationIds && updateUserInput.organizationIds.length) {\n            updateUserInput.organizationIds.forEach(async organizationId => {\n                await this.userRepo.createQueryBuilder('user').relation(User, 'organizations').of(user).remove(organizationId.before);\n                await this.userRepo.createQueryBuilder('user').relation(User, 'organizations').of(user).add(organizationId.after);\n            });\n        }\n        if (updateUserInput.infoKVs && updateUserInput.infoKVs.length) {\n            await this.createOrUpdateUserInfos(user, updateUserInput.infoKVs, 'update');\n        }\n    }\n\n    /**\n     * Query the user by role ID\n     *\n     * @param roleId The specified role id\n     */\n    async findByRoleId(roleId: number) {\n        const users = await this.userRepo.createQueryBuilder('user')\n            .leftJoinAndSelect('user.roles', 'roles')\n            .where('roles.id = :roleId', { roleId })\n            .andWhere('user.recycle = false')\n            .getMany();\n        if (!users.length) {\n            throw new HttpException(t('No users belong to this role'), 404);\n        }\n        return this.findUserInfoById(users.map(user => user.id)) as Promise<UserInfoData[]>;\n    }\n\n    /**\n     * Query users that belongs to the organization\n     *\n     * @param id The specified organization id\n     */\n    async findByOrganizationId(organizationId: number): Promise<UserInfoData[]> {\n        const users = await this.userRepo.createQueryBuilder('user')\n            .leftJoinAndSelect('user.organizations', 'organizations')\n            .where('organizations.id = :organizationId', { organizationId })\n            .andWhere('user.recycle = false')\n            .getMany();\n        if (!users.length) {\n            throw new HttpException(t('No users belong to this organization'), 404);\n        }\n        return this.findUserInfoById(users.map(user => user.id)) as Promise<UserInfoData[]>;\n    }\n\n    /**\n     * Querying users and their associated information by username\n     *\n     * @param username username\n     */\n    async findOneWithRolesAndPermissions(loginName: string): Promise<User> {\n        const user = await this.userRepo.createQueryBuilder('user')\n            .leftJoinAndSelect('user.roles', 'roles')\n            .leftJoinAndSelect('roles.permissions', 'permissions')\n            .where('user.username = :loginName', { loginName })\n            .orWhere('user.mobile = :loginName', { loginName })\n            .orWhere('user.email = :loginName', { loginName: loginName.toLocaleLowerCase() })\n            .getOne();\n\n        if (!user) {\n            throw new HttpException(t('User does not exist'), 404);\n        }\n        return user;\n    }\n\n    /**\n     * Querying user information by user ID\n     *\n     * @param id The specified user id\n     */\n    async findUserInfoById(id: number | number[]): Promise<UserInfoData | UserInfoData[]> {\n        const userQb = this.userRepo.createQueryBuilder('user')\n            .leftJoinAndSelect('user.roles', 'roles')\n            .leftJoinAndSelect('user.organizations', 'organizations')\n            .leftJoinAndSelect('user.userInfos', 'userInfos')\n            .leftJoinAndSelect('userInfos.infoItem', 'infoItem');\n\n        const infoItemQb = await this.infoItemRepo.createQueryBuilder('infoItem')\n            .leftJoin('infoItem.infoGroups', 'infoGroups')\n            .leftJoin('infoGroups.role', 'role')\n            .leftJoin('role.users', 'users');\n\n        if (id instanceof Array) {\n            const userInfoData: UserInfoData[] = [];\n            const users = await userQb.whereInIds(id).getMany();\n            const infoItems = await infoItemQb.where('users.id IN (:...id)', { id }).orderBy('infoItem.order', 'ASC').getMany();\n            for (const user of users) {\n                (userInfoData as UserInfoData[]).push(this.refactorUserData(user, infoItems));\n            }\n            return userInfoData;\n        } else {\n            const user = await userQb.where('user.id = :id', { id }).getOne();\n            const infoItem = await infoItemQb.where('users.id = :id', { id }).orderBy('infoItem.order', 'ASC').getMany();\n            return this.refactorUserData(user, infoItem);\n        }\n    }\n\n    /**\n     * Querying all of its information items through a user role\n     *\n     * @param roleIds The specified role id array\n     */\n    async findOneWithInfoItemsByRoleIds(roleIds: number[]) {\n        return this.roleService.findInfoGroupItemsByIds(roleIds);\n    }\n\n    /**\n     * user login by username or email\n     *\n     * @param loginName loginName: username or email\n     * @param password password\n     */\n    async login(loginName: string, password: string) {\n        const user = await this.userRepo.createQueryBuilder('user')\n            .leftJoinAndSelect('user.roles', 'roles')\n            .leftJoinAndSelect('user.organizations', 'organizations')\n            .leftJoinAndSelect('user.userInfos', 'userInfos')\n            .leftJoinAndSelect('userInfos.infoItem', 'infoItem')\n            .where('user.username = :loginName', { loginName })\n            .orWhere('user.mobile = :loginName', { loginName })\n            .orWhere('user.email = :loginName', { loginName: loginName.toLocaleLowerCase() })\n            .getOne();\n\n        await this.checkUserStatus(user);\n        if (!await this.cryptoUtil.checkPassword(password, user.password)) {\n            throw new HttpException(t('invalid password'), 406);\n        }\n\n        const infoItem = await this.infoItemRepo.createQueryBuilder('infoItem')\n            .leftJoin('infoItem.infoGroups', 'infoGroups')\n            .leftJoin('infoGroups.role', 'role')\n            .leftJoin('role.users', 'users')\n            .where('users.username = :loginName', { loginName })\n            .orWhere('users.mobile = :loginName', { loginName })\n            .orWhere('users.email = :loginName', { loginName: loginName.toLocaleLowerCase() })\n            .orderBy('infoItem.order', 'ASC')\n            .getMany();\n\n        const userInfoData = this.refactorUserData(user, infoItem);\n\n        const tokenInfo = await this.authService.createToken({ loginName });\n        return { tokenInfo, userInfoData };\n    }\n\n    /**\n     * user login by mobile (use tencent cloud sms service)\n     *\n     * @param mobile mobile\n     * @param validationCode validationCode\n     */\n    async mobileLogin(mobile: string, validationCode: number) {\n        await this.smsComponentProvider.smsValidator(mobile, validationCode);\n\n        const user = await this.userRepo.findOne({ mobile }, { relations: ['roles', 'organizations', 'userInfos', 'userInfos.infoItem'] });\n        await this.checkUserStatus(user);\n\n        const infoItem = await this.infoItemRepo.createQueryBuilder('infoItem')\n            .leftJoin('infoItem.infoGroups', 'infoGroups')\n            .leftJoin('infoGroups.role', 'role')\n            .leftJoin('role.users', 'users')\n            .where('users.mobile = :mobile', { mobile })\n            .orderBy('infoItem.order', 'ASC')\n            .getMany();\n\n        const userInfoData = this.refactorUserData(user, infoItem);\n\n        const tokenInfo = await this.authService.createToken({ loginName: mobile });\n        return { tokenInfo, userInfoData };\n    }\n\n    /**\n     * Ordinary user registration\n     *\n     * @param username username\n     * @param password password\n     */\n    async register(createUserInput: CreateUserInput): Promise<void> {\n        createUserInput.roleIds = [1];\n        await this.createUser(createUserInput);\n    }\n\n    private checkUserStatus(user: User) {\n        if (!user) throw new HttpException(t('User does not exist'), 404);\n        if (user.banned || user.recycle) throw new HttpException(t('User is banned'), 400);\n    }\n\n    /**\n     * Query users by ID\n     *\n     * @param id The specified user id\n     */\n    private async findOneById(id: number): Promise<User> {\n        const exist = this.userRepo.findOne(id);\n        if (!exist) {\n            throw new HttpException(t('User does not exist'), 404);\n        }\n        return exist;\n    }\n\n    /**\n     * Create or update the value of a user information item\n     *\n     * @param user The user object\n     * @param infoKVs Information item key-value pair, key is the ID of the information item (infoItem.id),\n     * and the value is the value of the information item (userInfo.value)\n     *\n     * @param action Operation type, create or update (create | update)\n     */\n    private async createOrUpdateUserInfos(user: User, infoKVs: { key: number, value: string, relationId?: number }[], action: 'create' | 'update') {\n        if (infoKVs.length) {\n            if (action === 'create') {\n                infoKVs.forEach(async infoKV => {\n                    await this.userInfoRepo.save(this.userInfoRepo.create({ value: infoKV.value, user, infoItem: { id: infoKV.key } }));\n                });\n                return;\n            }\n\n            infoKVs.forEach(async infoKV => {\n                if (infoKV.key) {\n                    this.userInfoRepo.update(infoKV.key, { value: infoKV.value });\n                } else {\n                    await this.userInfoRepo.save(this.userInfoRepo.create({ value: infoKV.value, user, infoItem: { id: infoKV.relationId } }));\n                }\n            });\n        }\n    }\n\n    /**\n     * Refactor the user information data\n     *\n     * @param user The user object\n     */\n    private refactorUserData(user: User, infoItems: InfoItem[]) {\n        const userInfoData: UserInfoData = {\n            userId: user.id,\n            username: user.username,\n            email: user.email,\n            mobile: user.mobile,\n            banned: user.banned,\n            recycle: user.recycle,\n            createTime: user.createTime,\n            updateTime: user.updateTime,\n            userRoles: user.roles,\n            userOrganizations: user.organizations,\n            userInfos: infoItems.length ? infoItems.map(infoItem => {\n                const userInfo = user.userInfos.find(userInfo => userInfo.infoItem.id === infoItem.id);\n                return {\n                    id: user.userInfos.length ? (userInfo ? userInfo.id : undefined) : undefined,\n                    order: infoItem.order,\n                    relationId: infoItem.id,\n                    type: infoItem.type,\n                    name: infoItem.name,\n                    value: user.userInfos.length ? (userInfo ? userInfo.value : undefined) : undefined,\n                    description: infoItem.description,\n                    registerDisplay: infoItem.registerDisplay,\n                    informationDisplay: infoItem.informationDisplay\n                };\n            }) : []\n        };\n        return userInfoData;\n    }\n}"]}